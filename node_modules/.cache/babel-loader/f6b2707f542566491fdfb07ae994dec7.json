{"ast":null,"code":"import _toConsumableArray from\"/Users/mocaa7/src/git-website/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/mocaa7/src/git-website/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mocaa7/src/git-website/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/mocaa7/src/git-website/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mocaa7/src/git-website/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/mocaa7/src/git-website/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/mocaa7/src/git-website/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/mocaa7/src/git-website/node_modules/@babel/runtime/helpers/esm/inherits\";import React from\"react\";import{connect}from\"react-redux\";import'../../node_modules/bootstrap/dist/css/bootstrap.css';import'../../node_modules/font-awesome/css/font-awesome.min.css';import'../components/CourseEditor/CourseEditor.css';import'../components/CourseManager/CourseManager.css';import{createWidget as _createWidget,deleteWidget as _deleteWidget,findAllWidgetsForTopic as _findAllWidgetsForTopic,updateWidget as _updateWidget,saveAllWidgets as _saveAllWidgets,moveWidgetUp as _moveWidgetUp,moveWidgetDown as _moveWidgetDown}from'../actions/widgetActions';import WidgetService from'../services/WidgetService';import HeadingWidgetComponent from'../components/CourseEditor/Widgets/HeadingWidgetComponent';import ParagraphWidgetComponent from'../components/CourseEditor/Widgets/ParagraphWidgetComponent';import ListWidgetComponent from'../components/CourseEditor/Widgets/ListWidgetComponent';import ImageWidgetComponent from\"../components/CourseEditor/Widgets/ImageWidgetComponent\";import SaveAndPreviewComponent from'../components/CourseEditor/Widgets/SaveAndPreviewComponent';var service=new WidgetService();var headingWidget=function headingWidget(id,widgetOrder){return{id:id,name:\"\",widgetType:HEADING,widgetOrder:widgetOrder,width:-1,height:-1,cssClass:\"\",style:\"\",value:\"\",text:\"\",size:DEFAULT_SIZE};};var HEADING='Heading';var PARAGRAPH='Paragraph';var IMAGE='Image';var LIST='List';var DEFAULT_SIZE=1;var WidgetListContainer=/*#__PURE__*/function(_React$Component){_inherits(WidgetListContainer,_React$Component);function WidgetListContainer(props){var _this;_classCallCheck(this,WidgetListContainer);_this=_possibleConstructorReturn(this,_getPrototypeOf(WidgetListContainer).call(this,props));_this.state={widgets:[],nextId:-1,isPreviewing:false};_this.updateWidgets();return _this;}_createClass(WidgetListContainer,[{key:\"getLastElement\",value:function getLastElement(){return this.state.widgets.length-1;}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(prevProps.topicId!==this.props.topicId){this.updateWidgets();}}},{key:\"onSaveAll\",value:function(){var _onSaveAll=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.props.saveAllWidgets(this.props.topicId,this.state.widgets);case 2:case\"end\":return _context.stop();}}},_callee,this);}));function onSaveAll(){return _onSaveAll.apply(this,arguments);}return onSaveAll;}()},{key:\"updateWidgets\",value:function(){var _updateWidgets=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var widgets;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return service.findWidgetsForTopic(this.props.topicId);case 2:widgets=_context2.sent;this.setState({widgets:widgets});case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function updateWidgets(){return _updateWidgets.apply(this,arguments);}return updateWidgets;}()},{key:\"addWidget\",value:function(){var _addWidget=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var newId,newWidget;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:newId=this.state.nextId;this.setState({nextId:--this.state.nextId});// let newWidget = headingWidget((new Date()).getTime(), this.state.widgets.length);\nnewWidget=headingWidget(newId,this.state.widgets.length);this.setState({widgets:[].concat(_toConsumableArray(this.state.widgets),[newWidget])});// this.props.createWidget(this.props.topicId, widgetId);\ncase 4:case\"end\":return _context3.stop();}}},_callee3,this);}));function addWidget(){return _addWidget.apply(this,arguments);}return addWidget;}()},{key:\"onDelete\",value:function onDelete(widgetId){var newWidgets=this.state.widgets.filter(function(widget){return widget.id!==widgetId;});this.setState({widgets:newWidgets});// this.props.deleteWidget(widgetId);\n}},{key:\"swapElements\",value:function swapElements(widgets,x,y){var temp=widgets[x];widgets[x]=widgets[y];widgets[y]=temp;widgets[x].widgetOrder=x;widgets[y].widgetOrder=y;return widgets;}},{key:\"moveUp\",value:function(){var _moveUp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(widget){var index;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:index=this.state.widgets.indexOf(widget);this.setState({widgets:this.swapElements(this.state.widgets,index,index-1)});// this.props.moveWidgetUp(widget, this.state.widgets[index - 1]);\ncase 2:case\"end\":return _context4.stop();}}},_callee4,this);}));function moveUp(_x){return _moveUp.apply(this,arguments);}return moveUp;}()},{key:\"moveDown\",value:function(){var _moveDown=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(widget){var index;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:index=this.state.widgets.indexOf(widget);this.setState({widgets:this.swapElements(this.state.widgets,index,index+1)});// this.props.moveWidgetDown(widget, this.state.widgets[index + 1]);\ncase 2:case\"end\":return _context5.stop();}}},_callee5,this);}));function moveDown(_x2){return _moveDown.apply(this,arguments);}return moveDown;}()},{key:\"updateWidget\",value:function updateWidget(newWidget){this.setState({widgets:this.state.widgets.map(function(widget){return widget.id===newWidget.id?newWidget:widget;})});}},{key:\"updatePreview\",value:function updatePreview(){this.setState({isPreviewing:!this.state.isPreviewing});}},{key:\"render\",value:function render(){var _this2=this;return React.createElement(\"span\",null,React.createElement(SaveAndPreviewComponent,{key:this.props.topicId,saveAll:this.onSaveAll.bind(this),isPreviewing:this.state.isPreviewing,updatePreview:this.updatePreview.bind(this)}),React.createElement(\"div\",null,this.state.widgets&&this.state.widgets.map(function(widget,index){return React.createElement(\"div\",null,React.createElement(\"div\",{className:\"col container fluid wbdv-widget info\"},(!widget.widgetType||widget.widgetType===HEADING)&&React.createElement(HeadingWidgetComponent,{key:widget.id,widget:widget,widgetOrder:index,getLastElement:_this2.getLastElement.bind(_this2),moveUp:_this2.moveUp.bind(_this2,widget),moveDown:_this2.moveDown.bind(_this2,widget),onDelete:_this2.onDelete.bind(_this2,widget.id),size:widget.size?widget.size:DEFAULT_SIZE,name:widget.name||'',text:widget.text||'',updateWidget:_this2.updateWidget.bind(_this2,widget),updateWidgetType:_this2.updateWidget.bind(_this2),isPreviewing:_this2.state.isPreviewing}),widget.widgetType===PARAGRAPH&&React.createElement(ParagraphWidgetComponent,{key:widget.id,widget:widget,widgetOrder:index,getLastElement:_this2.getLastElement.bind(_this2),moveUp:_this2.moveUp.bind(_this2,widget),moveDown:_this2.moveDown.bind(_this2,widget),onDelete:_this2.onDelete.bind(_this2,widget.id),name:widget.name||'',text:widget.text||'',updateWidget:_this2.updateWidget.bind(_this2,widget),updateWidgetType:_this2.updateWidget.bind(_this2),isPreviewing:_this2.state.isPreviewing}),widget.widgetType===LIST&&React.createElement(ListWidgetComponent,{key:widget.id,widget:widget,widgetOrder:index,getLastElement:_this2.getLastElement.bind(_this2),moveUp:_this2.moveUp.bind(_this2,widget),moveDown:_this2.moveDown.bind(_this2,widget),onDelete:_this2.onDelete.bind(_this2,widget.id),name:widget.name||'',items:widget.items||'',updateWidget:_this2.updateWidget.bind(_this2,widget),updateWidgetType:_this2.updateWidget.bind(_this2),isPreviewing:_this2.state.isPreviewing}),widget.widgetType===IMAGE&&React.createElement(ImageWidgetComponent,{key:widget.id,widget:widget,widgetOrder:index,getLastElement:_this2.getLastElement.bind(_this2),moveUp:_this2.moveUp.bind(_this2,widget),moveDown:_this2.moveDown.bind(_this2,widget),onDelete:_this2.onDelete.bind(_this2,widget.id),name:widget.name||'',url:widget.url||'',updateWidget:_this2.updateWidget.bind(_this2,widget),updateWidgetType:_this2.updateWidget.bind(_this2),isPreviewing:_this2.state.isPreviewing})));}),!this.state.isPreviewing&&React.createElement(\"div\",{className:\"nav-item\",onClick:function onClick(){return _this2.addWidget();}},React.createElement(\"i\",{className:\"nav-link fa fa-plus-circle fa-2x\"}))));}}]);return WidgetListContainer;}(React.Component);var stateToPropertyMapper=function stateToPropertyMapper(state){return{widgets:state.widgets.widgets};};var dispatchToPropertyMapper=function dispatchToPropertyMapper(dispatch){return{createWidget:function createWidget(topicId,widgetId){return dispatch(_createWidget(topicId,widgetId));},findAllWidgetsForTopic:function findAllWidgetsForTopic(topicId){return service.findWidgetsForTopic(topicId).then(function(actualWidgets){return dispatch(_findAllWidgetsForTopic(actualWidgets));});},updateWidget:function updateWidget(widget){return dispatch(_updateWidget(widget));},deleteWidget:function deleteWidget(widgetId){return dispatch(_deleteWidget(widgetId));},saveAllWidgets:function saveAllWidgets(topicId,widgets){return service.saveAllWidgets(topicId,widgets).then(function(returnedWidgets){return dispatch(_saveAllWidgets(returnedWidgets));});},moveWidgetUp:function moveWidgetUp(widget,other){return dispatch(_moveWidgetUp(widget,other));},moveWidgetDown:function moveWidgetDown(widget,other){return dispatch(_moveWidgetDown(widget,other));}};};export default connect(stateToPropertyMapper,dispatchToPropertyMapper)(WidgetListContainer);","map":{"version":3,"sources":["/Users/mocaa7/src/git-website/src/containers/WidgetListContainer.js"],"names":["React","connect","createWidget","deleteWidget","findAllWidgetsForTopic","updateWidget","saveAllWidgets","moveWidgetUp","moveWidgetDown","WidgetService","HeadingWidgetComponent","ParagraphWidgetComponent","ListWidgetComponent","ImageWidgetComponent","SaveAndPreviewComponent","service","headingWidget","id","widgetOrder","name","widgetType","HEADING","width","height","cssClass","style","value","text","size","DEFAULT_SIZE","PARAGRAPH","IMAGE","LIST","WidgetListContainer","props","state","widgets","nextId","isPreviewing","updateWidgets","length","prevProps","topicId","findWidgetsForTopic","setState","newId","newWidget","widgetId","newWidgets","filter","widget","x","y","temp","index","indexOf","swapElements","map","onSaveAll","bind","updatePreview","getLastElement","moveUp","moveDown","onDelete","items","url","addWidget","Component","stateToPropertyMapper","dispatchToPropertyMapper","dispatch","then","actualWidgets","returnedWidgets","other"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { connect } from \"react-redux\";\nimport '../../node_modules/bootstrap/dist/css/bootstrap.css'\nimport '../../node_modules/font-awesome/css/font-awesome.min.css';\nimport '../components/CourseEditor/CourseEditor.css';\nimport '../components/CourseManager/CourseManager.css';\nimport { createWidget, deleteWidget, findAllWidgetsForTopic, updateWidget, saveAllWidgets, moveWidgetUp, moveWidgetDown } from '../actions/widgetActions';\nimport WidgetService from '../services/WidgetService';\nimport HeadingWidgetComponent from '../components/CourseEditor/Widgets/HeadingWidgetComponent';\nimport ParagraphWidgetComponent from '../components/CourseEditor/Widgets/ParagraphWidgetComponent';\nimport ListWidgetComponent from '../components/CourseEditor/Widgets/ListWidgetComponent';\nimport ImageWidgetComponent from \"../components/CourseEditor/Widgets/ImageWidgetComponent\";\nimport SaveAndPreviewComponent from '../components/CourseEditor/Widgets/SaveAndPreviewComponent';\n\nconst service = new WidgetService();\n\nconst headingWidget = (id, widgetOrder) => {\n  return { id: id, name: \"\", widgetType: HEADING, widgetOrder: widgetOrder, width: -1, height: -1, cssClass: \"\", style: \"\", value: \"\", text: \"\", size: DEFAULT_SIZE };\n}\n\nconst HEADING = 'Heading';\nconst PARAGRAPH = 'Paragraph';\nconst IMAGE = 'Image';\nconst LIST = 'List';\nconst DEFAULT_SIZE = 1;\n\nclass WidgetListContainer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      widgets: [],\n      nextId: -1,\n      isPreviewing: false\n    };\n\n    this.updateWidgets();\n  }\n\n  getLastElement() {\n    return this.state.widgets.length - 1;\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.topicId !== this.props.topicId) {\n      this.updateWidgets();\n    }\n  }\n\n  async onSaveAll() {\n    await this.props.saveAllWidgets(this.props.topicId, this.state.widgets);\n  }\n\n  async updateWidgets() {\n    const widgets = await service.findWidgetsForTopic(this.props.topicId);\n    this.setState({ widgets: widgets });\n  }\n\n  async addWidget() {\n    let newId = this.state.nextId;\n    this.setState({ nextId: --this.state.nextId });\n    // let newWidget = headingWidget((new Date()).getTime(), this.state.widgets.length);\n    let newWidget = headingWidget(newId, this.state.widgets.length);\n    this.setState({ widgets: [...this.state.widgets, newWidget] });\n    // this.props.createWidget(this.props.topicId, widgetId);\n  }\n\n  onDelete(widgetId) {\n    let newWidgets = this.state.widgets.filter(widget => widget.id !== widgetId);\n    this.setState({ widgets: newWidgets });\n    // this.props.deleteWidget(widgetId);\n  }\n\n  swapElements(widgets, x, y) {\n    let temp = widgets[x];\n    widgets[x] = widgets[y];\n    widgets[y] = temp;\n    widgets[x].widgetOrder = x;\n    widgets[y].widgetOrder = y;\n    return widgets;\n  }\n\n  async moveUp(widget) {\n    let index = this.state.widgets.indexOf(widget);\n    this.setState(\n      { widgets: this.swapElements(this.state.widgets, index, index - 1) });\n    // this.props.moveWidgetUp(widget, this.state.widgets[index - 1]);\n  }\n\n  async moveDown(widget) {\n    let index = this.state.widgets.indexOf(widget);\n    this.setState(\n      { widgets: this.swapElements(this.state.widgets, index, index + 1) });\n    // this.props.moveWidgetDown(widget, this.state.widgets[index + 1]);\n  }\n\n  updateWidget(newWidget) {\n    this.setState({\n      widgets: this.state.widgets.map(widget =>\n        widget.id === newWidget.id ? newWidget : widget)\n    });\n  }\n\n  updatePreview() {\n    this.setState({ isPreviewing: !this.state.isPreviewing });\n  }\n\n  render() {\n    return (\n      <span>\n        <SaveAndPreviewComponent\n          key={this.props.topicId}\n          saveAll={this.onSaveAll.bind(this)}\n          isPreviewing={this.state.isPreviewing}\n          updatePreview={this.updatePreview.bind(this)} />\n        <div>\n          {this.state.widgets && this.state.widgets.map((widget, index) =>\n            <div>\n              <div className={\"col container fluid wbdv-widget info\"}>\n                {(!widget.widgetType || widget.widgetType === HEADING) &&\n                  <HeadingWidgetComponent\n                    key={widget.id}\n                    widget={widget}\n                    widgetOrder={index}\n                    getLastElement={this.getLastElement.bind(this)}\n                    moveUp={this.moveUp.bind(this, widget)}\n                    moveDown={this.moveDown.bind(this, widget)}\n                    onDelete={this.onDelete.bind(this, widget.id)}\n                    size={widget.size ? widget.size : DEFAULT_SIZE}\n                    name={widget.name || ''}\n                    text={widget.text || ''}\n                    updateWidget={this.updateWidget.bind(this, widget)}\n                    updateWidgetType={this.updateWidget.bind(this)}\n                    isPreviewing={this.state.isPreviewing} />}\n\n                {widget.widgetType === PARAGRAPH &&\n                  <ParagraphWidgetComponent\n                    key={widget.id}\n                    widget={widget}\n                    widgetOrder={index}\n                    getLastElement={this.getLastElement.bind(this)}\n                    moveUp={this.moveUp.bind(this, widget)}\n                    moveDown={this.moveDown.bind(this, widget)}\n                    onDelete={this.onDelete.bind(this, widget.id)}\n                    name={widget.name || ''}\n                    text={widget.text || ''}\n                    updateWidget={this.updateWidget.bind(this, widget)}\n                    updateWidgetType={this.updateWidget.bind(this)}\n                    isPreviewing={this.state.isPreviewing} />}\n\n                {widget.widgetType === LIST &&\n                  <ListWidgetComponent\n                    key={widget.id}\n                    widget={widget}\n                    widgetOrder={index}\n                    getLastElement={this.getLastElement.bind(this)}\n                    moveUp={this.moveUp.bind(this, widget)}\n                    moveDown={this.moveDown.bind(this, widget)}\n                    onDelete={this.onDelete.bind(this, widget.id)}\n                    name={widget.name || ''}\n                    items={widget.items || ''}\n                    updateWidget={this.updateWidget.bind(this, widget)}\n                    updateWidgetType={this.updateWidget.bind(this)}\n                    isPreviewing={this.state.isPreviewing} />}\n\n                {(widget.widgetType === IMAGE) &&\n                  <ImageWidgetComponent\n                    key={widget.id}\n                    widget={widget}\n                    widgetOrder={index}\n                    getLastElement={this.getLastElement.bind(this)}\n                    moveUp={this.moveUp.bind(this, widget)}\n                    moveDown={this.moveDown.bind(this, widget)}\n                    onDelete={this.onDelete.bind(this, widget.id)}\n                    name={widget.name || ''}\n                    url={widget.url || ''}\n                    updateWidget={this.updateWidget.bind(this, widget)}\n                    updateWidgetType={this.updateWidget.bind(this)}\n                    isPreviewing={this.state.isPreviewing} />}\n              </div>\n            </div>\n          )\n          }\n          {!this.state.isPreviewing &&\n            <div className=\"nav-item\" onClick={() => this.addWidget()}>\n              <i className=\"nav-link fa fa-plus-circle fa-2x\" />\n            </div>}\n        </div>\n      </span>\n    )\n  }\n}\n\nconst stateToPropertyMapper = (state) => {\n  return {\n    widgets: state.widgets.widgets\n  }\n};\n\nconst dispatchToPropertyMapper = (dispatch) => {\n  return {\n    createWidget: (topicId, widgetId) =>\n      dispatch(createWidget(topicId, widgetId)),\n\n    findAllWidgetsForTopic: (topicId) =>\n      service.findWidgetsForTopic(topicId)\n        .then(actualWidgets =>\n          dispatch(findAllWidgetsForTopic(actualWidgets))),\n\n    updateWidget: (widget) =>\n      dispatch(updateWidget(widget)),\n\n    deleteWidget: (widgetId) =>\n      dispatch(deleteWidget(widgetId)),\n\n    saveAllWidgets: (topicId, widgets) =>\n      service.saveAllWidgets(topicId, widgets)\n        .then(returnedWidgets =>\n          dispatch(saveAllWidgets(returnedWidgets))),\n\n    moveWidgetUp: (widget, other) =>\n      dispatch(moveWidgetUp(widget, other)),\n\n    moveWidgetDown: (widget, other) =>\n      dispatch(moveWidgetDown(widget, other))\n  }\n};\n\nexport default connect(\n  stateToPropertyMapper,\n  dispatchToPropertyMapper)\n  (WidgetListContainer)"]},"metadata":{},"sourceType":"module"}